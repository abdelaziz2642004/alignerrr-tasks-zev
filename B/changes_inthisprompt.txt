The implementation is complete. Here's a summary of the updated changes:

  Summary of Changes

  Key Behavioral Change

  - Automatic feedback collection: Instead of requiring users to run zev --feedback, feedback is now collected
  automatically at the start of the next zev run when there's a pending command.

  Updated Files

  src/zev/command_history.py
  - Enhanced CommandFeedback model with failure_notes: Optional[str] field
  - Updated save_feedback() to accept optional failure_notes parameter
  - Updated _feedback_callback() to pass failure notes to storage

  src/zev/command_selector.py
  - Removed the tip message about --feedback (since it's now automatic)
  - Updated _store_pending_feedback() to remove unused callback parameter
  - Updated prompt_for_feedback() to ask for optional failure notes when a command fails

  src/zev/main.py
  - Added check_pending_feedback() function that checks for pending feedback and prompts automatically
  - Simplified handle_feedback() to just show stats (since feedback is collected automatically)
  - Updated app() to call check_pending_feedback() before processing new queries
  - Updated show_feedback_stats() to display failure notes in recent feedback list

  src/zev/utils.py
  - Updated help text to explain automatic feedback collection

  User Flow

  1. User runs zev "find large files" and selects a command → command copied to clipboard, pending feedback stored
  2. User runs the command in their terminal
  3. User runs zev again (for any query) → automatically prompted: "Did the command work?"
  4. If "No, it failed" → prompted for optional notes: "What went wrong?"
  5. Feedback stored with command, query, status, timestamp, and optional failure notes
  6. User can view stats anytime with zev --feedback