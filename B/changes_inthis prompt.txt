Both cases work correctly. The enhanced get_env_context() function now provides:

  Summary of changes to src/zev/utils.py:

  1. Added subprocess import - needed for running git commands
  2. New _get_git_info() helper function that:
    - Checks if the current directory is inside a git repository
    - Gets the current branch name (handles detached HEAD state)
    - Gets a status summary showing counts of staged, modified, and untracked files
  3. Enhanced get_env_context() function now returns:
    - OS: - Operating system information (unchanged)
    - SHELL: - Shell path (unchanged)
    - CWD: - Current working directory path (new)
    - GIT_REPO: - Whether it's a git repository (yes/no) (new)
    - GIT_BRANCH: - Current branch name (new, only if in git repo)
    - GIT_STATUS: - Summary like "3 staged, 2 modified, 5 untracked" or "clean" (new, only if in git repo)

  Example output in a git repo:
  OS: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.35
  SHELL: /bin/bash
  CWD: /home/user/project
  GIT_REPO: yes
  GIT_BRANCH: main
  GIT_STATUS: 1 staged, 25 modified, 2 untracked

  Example output outside a git repo:
  OS: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.35
  SHELL: /bin/bash
  CWD: /tmp
  GIT_REPO: no