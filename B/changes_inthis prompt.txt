The implementation is complete. Here's a summary of the changes made:

  Summary: Workflow Variables Support

  Modified Files:

  1. src/zev/llms/types.py:
    - Added variables: dict[str, str] field to WorkflowState to persist variable values across sessions
  2. src/zev/command_selector.py:
    - Added VARIABLE_PATTERN regex to match {{variable_name}} syntax
    - Added extract_variables(workflow) - extracts all unique variable names from a workflow
    - Added substitute_variables(command, variables) - replaces placeholders with actual values
    - Added prompt_for_variables(variables, existing_values) - prompts user to enter values
    - Added has_variables(workflow) - checks if workflow contains variables
    - Updated handle_workflow() to detect variables, prompt for values, and show preview
    - Updated run_workflow_all() to use variable substitution and save values to state
    - Updated run_workflow_interactive() to use variable substitution and save values to state
    - Updated copy_workflow_commands() to apply variable substitution
    - Updated resume_workflow() to show saved variables and allow updating them
  3. src/zev/constants.py:
    - Updated LLM prompt with WORKFLOW VARIABLES section explaining the {{variable_name}} syntax
    - Added examples showing variables like {{commit_message}} and {{branch_name}}

  Usage:

  When the LLM returns a workflow with variables like:
  git checkout -b {{branch_name}}
  git commit -m '{{commit_message}}'

  The user will see:
  Variables detected: {{branch_name}}, {{commit_message}}

  This workflow requires input values:

    Branch Name: feature/my-feature
    Commit Message: Add new feature

  Commands with your values:
    1. git checkout -b feature/my-feature
    2. git commit -m 'Add new feature'

  When resuming an interrupted workflow with zev --resume, variables are:
  - Displayed with their saved values
  - Can be updated via "Update variable values" option
  - Automatically applied during execution